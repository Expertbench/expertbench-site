<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ExpertBench — Our Experts</title>

  <!-- Favicon -->
  <link rel="icon" href="favicon.svg" type="image/svg+xml">

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-1:#0b1220;
      --bg-2:#0c1a33;
      --card:#0f223f;
      --muted:#9fb3c8;
      --text:#e9f0f7;
      --primary:#0B3D91;
      --secondary:#3178C6;
      --accent:#00BFA6;
      --line:rgba(255,255,255,0.08);
      --shadow:0 10px 40px rgba(5,15,35,0.5);
      --radius:16px;
      --gap:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text); background:
        radial-gradient(1200px 600px at 15% -10%, #153260 0%, transparent 55%),
        radial-gradient(900px 500px at 120% 20%, #0e2a55 0%, transparent 60%),
        linear-gradient(180deg, var(--bg-1) 0%, var(--bg-2) 100%);
      line-height:1.55;
    }
    .container{max-width:1080px;margin:auto;padding:24px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:var(--text)}
    .logo{
      width:44px;height:44px;border-radius:12px;
      background:linear-gradient(180deg,var(--secondary),var(--primary));
      display:grid;place-items:center;box-shadow:0 8px 30px rgba(30,100,200,0.35);
    }
    .logo svg{width:22px;height:22px}
    .name{font-weight:800;letter-spacing:.2px;font-size:18px}
    nav a{color:var(--muted); text-decoration:none; margin-left:16px; font-size:14px}
    nav a:hover{color:var(--accent)}

    h1{text-align:center;font-size:32px;margin:24px 0}
    .grid{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
      gap:20px;margin-top:20px
    }

    /* Modern expert cards (keeps your palette + vibe) */
    .card{
      position:relative;
      background:linear-gradient(180deg,rgba(255,255,255,0.06),rgba(255,255,255,0.025));
      border:1px solid var(--line); border-radius:var(--radius);
      padding:20px; box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card::before{
      content:"";
      position:absolute; inset:-1px;
      background:radial-gradient(600px 200px at 120% -20%, rgba(49,120,198,0.20), transparent 70%),
                 radial-gradient(400px 160px at -20% 120%, rgba(0,191,166,0.16), transparent 70%);
      pointer-events:none;
    }
    .card h2{margin:0 0 6px;font-size:18px}
    .row{display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap}
    .role{font-weight:600;margin-bottom:2px;color:var(--accent)}
    .muted{color:var(--muted);font-size:13px}
    .skills,.expertise,.sectors{font-size:14px;margin:8px 0 0}
    .pill{
      display:inline-block;padding:6px 10px;border-radius:999px;
      background:rgba(255,255,255,0.06);border:1px solid var(--line);font-size:12px;color:var(--muted);
      margin-right:6px;margin-top:6px
    }
    .actions{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap}
    .btn{
      display:inline-block;padding:10px 14px;border-radius:10px;text-decoration:none;
      background:#2563eb;color:#fff;font-weight:600;font-size:14px;
      transition:transform .15s ease, filter .15s ease;
    }
    .btn:hover{transform:translateY(-2px); filter:brightness(1.05)}
    .btn.secondary{background:#10b981}
    .empty, .loading {text-align:center;color:var(--muted);padding:32px 12px}
    .skeleton{
      border-radius:var(--radius);height:180px;background:
      linear-gradient(90deg, rgba(255,255,255,0.08) 25%, rgba(255,255,255,0.18) 37%, rgba(255,255,255,0.08) 63%);
      background-size:400% 100%; animation:shimmer 1.25s infinite; border:1px solid var(--line)
    }
    @keyframes shimmer{0%{background-position:100% 0}100%{background-position:0 0}}

    footer{margin:28px 0 8px;text-align:center;color:var(--muted);font-size:13px}
    footer a{color:var(--muted); text-decoration:none; margin:0 6px}
    footer a:hover{color:var(--accent)}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <a class="brand" href="index.html" aria-label="ExpertBench home">
        <div class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none">
            <rect x="4" y="4" width="8" height="8" rx="2" fill="white" opacity="0.9"/>
            <rect x="12" y="8" width="8" height="8" rx="2" fill="white" opacity="0.7"/>
            <rect x="6" y="12" width="8" height="8" rx="2" fill="white" opacity="0.5"/>
          </svg>
        </div>
        <div class="name">ExpertBench</div>
      </a>
      <nav>
        <a href="index.html">Home</a>
        <a href="experts.html">Experts</a>
        <a href="projects.html">Projects</a>
      </nav>
    </header>

    <h1>Meet Our Experts</h1>

    <!-- Loading state -->
    <div id="loading" class="grid" aria-hidden="true">
      <div class="skeleton"></div>
      <div class="skeleton"></div>
      <div class="skeleton"></div>
    </div>

    <!-- Live experts go here -->
    <div id="experts" class="grid" style="display:none"></div>

    <div id="empty" class="empty" style="display:none">No experts published yet. Please check back soon.</div>

    <footer>
      © ExpertBench — Built for experts. Built for teams.<br>
      <a href="nda.html">NDA</a> ·
      <a href="terms.html">Terms</a> ·
      <a href="privacy.html">Privacy</a>
    </footer>
  </div>

  <script>
    // 1) Your Google Apps Script Web App URL (JSON feed)
    const API_URL = "https://script.google.com/macros/s/AKfycbwY2Ik4TOvD7oRqxwmix0eZdgAV34LWspRxZ-lhibgfJ1dfyZrzd5tUcC1kCIYgy5psdQ/exec";

    // 2) Optional: paste your Company Project Brief Google Form URL below
    // If left blank, the "Request Intro" button will be hidden.
    const CLIENT_FORM_URL = "YOUR_CLIENT_FORM_URL";

    // Map your exact column headers (from your sheet)
    const COL = {
      name: "Full Name",
      location: "Current Location",
      yoe: "Years Of Experience",
      expertise: "Areas of expertise",
      sectors: "Industry Sectors",
      linkedin: "LinkedIn Profile URL",
      travel: "Willing To Travel"
    };

    function safe(v){ return (v===undefined || v===null) ? "" : String(v).trim(); }
    function truncate(v, n){ v=safe(v); return v.length>n ? v.slice(0, n-1)+"…" : v; }
    function toPills(listStr, max=5){
      const items = safe(listStr).split(/,|·|\n|;/).map(s=>s.trim()).filter(Boolean);
      return items.slice(0, max).map(s=>`<span class="pill">${truncate(s,28)}</span>`).join("");
    }

    function cardHTML(row){
      const name = safe(row[COL.name]);
      const loc  = safe(row[COL.location]);

      // Years of Experience: show exactly as provided (e.g., "8-12 years" or "13+")
      let yoeRaw = safe(row[COL.yoe]);
      if (yoeRaw && !/\byear/i.test(yoeRaw)) yoeRaw = yoeRaw + " years"; // add "years" if missing
      const yoeText = yoeRaw ? `${yoeRaw} experience` : "Experienced Consultant";

      const exp  = truncate(row[COL.expertise], 220);
      const sec  = row[COL.sectors];
      const li   = safe(row[COL.linkedin]);
      const travel = safe(row[COL.travel]);

      const introBtn = CLIENT_FORM_URL
        ? `<a class="btn secondary" target="_blank" rel="noopener" href="${CLIENT_FORM_URL}">Request Intro</a>`
        : "";

      return `
        <article class="card">
          <div class="row">
            <div>
              <h2>${name}</h2>
              <div class="role">${yoeText}</div>
            </div>
            <div class="muted">${loc || ""}</div>
          </div>
          <div class="skills">${toPills(sec || "", 5)}</div>
          <div class="expertise"><strong>Expertise:</strong> ${exp || "—"}</div>
          ${travel ? `<div class="sectors muted">Travel: ${travel}</div>` : ""}
          <div class="actions">
            ${li ? `<a class="btn" target="_blank" rel="noopener" href="${li}">LinkedIn</a>` : ""}
            ${introBtn}
          </div>
        </article>
      `;
    }

    async function loadExperts(){
      const loading = document.getElementById("loading");
      const grid    = document.getElementById("experts");
      const empty   = document.getElementById("empty");

      try{
        const res = await fetch(API_URL, { cache: "no-store" });
        const json = await res.json();
        const data = (json && json.data) ? json.data : [];

        loading.style.display = "none";

        if(!data.length){
          empty.style.display = "block";
          return;
        }

        grid.innerHTML = data.map(cardHTML).join("");
        grid.style.display = "grid";
      }catch(e){
        console.error(e);
        loading.style.display = "none";
        empty.style.display = "block";
        empty.textContent = "We couldn’t load experts right now. Please refresh in a moment.";
      }
    }

    document.addEventListener("DOMContentLoaded", loadExperts);
  </script>
</body>
</html>

